---
title: "Twigãªã©ä»»æ„ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨€èªã§TailwindCSSã®ã‚¯ãƒ©ã‚¹ã‚’ã‚½ãƒ¼ãƒˆã§ãã‚‹Prettierãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½œã£ãŸ"
emoji: "ğŸƒ"
type: "tech"
topics: ["prettier", "tailwindcss", "twig", "php"]
published: true
---

# ä½œã£ãŸã‚‚ã®

https://github.com/ttskch/prettier-plugin-tailwindcss-anywhere/

ãƒ•ã‚¡ã‚¤ãƒ«å†…ã® `class="..."` ã«åˆè‡´ã™ã‚‹éƒ¨åˆ†ã ã‘ã« [prettier-plugin-tailwindcss](https://github.com/tailwindlabs/prettier-plugin-tailwindcss) ã«ã‚ˆã‚‹è‡ªå‹•æ•´å½¢ã‚’é©ç”¨ã—ã¦ãã‚Œã‚‹ã€ã¤ã¾ã‚Š **`class="..."` ã®éƒ¨åˆ†ä»¥å¤–ã«ã¯ä½•ã®æ•´å½¢ã‚‚ã›ãšã€ã‚¯ãƒ©ã‚¹åã®ã‚½ãƒ¼ãƒˆã ã‘ã‚’ã—ã¦ãã‚Œã‚‹** Prettierãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§ã™ã€‚

æ­£ç¢ºã«ã¯ã€ãƒãƒƒãƒã•ã›ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ `class="..."` ã«é™ã‚‰ãšè‡ªç”±ã«æ­£è¦è¡¨ç¾ã‚’è¨­å®šã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã‚ã‚‹ã®ã§ã€ç†è«–ä¸Šã¯ **ä»»æ„ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨€èªã«å¯¾å¿œã§ãã‚‹ã¯ãš** ã§ã™ã€‚

# ä½œã£ãŸå‹•æ©Ÿ

æœ€è¿‘ã€[Symfony](https://symfony.com/) + [Twig](https://twig.symfony.com/) æ§‹æˆã®MPAã§åˆã‚ã¦TailwindCSSã‚’ä½¿ã†æ©Ÿä¼šãŒã‚ã‚Šã¾ã—ãŸã€‚

TailwindCSSã®ã‚ˆã†ãªãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆCSSãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ã†å ´åˆã€ã‚¯ãƒ©ã‚¹åã®ä¸¦ã³é †ã‚’å°‘ã—ã§ã‚‚æ„è­˜ã—ã¦ã—ã¾ã†ã¨ç„¡é§„ã«èªçŸ¥ã‚³ã‚¹ãƒˆã‚’æ¶ˆè²»ã—ã¦å¿ƒç†çš„ã‚¹ãƒˆãƒ¬ã‚¹ãŒã™ã”ã„ã®ã§ã€ã‚¯ãƒ©ã‚¹åã¯çµ¶å¯¾ã«è‡ªå‹•ã§ã‚½ãƒ¼ãƒˆã•ã‚Œã¦ã»ã—ã„ã§ã™ã€‚

å¹¸ã„ã€TailwindCSSå…¬å¼ãŒæä¾›ã—ã¦ã„ã‚‹ [prettier-plugin-tailwindcss](https://github.com/tailwindlabs/prettier-plugin-tailwindcssv) ã¨ã„ã†ç´ æ™´ã‚‰ã—ã„Prettierãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ãˆã°ã‚¯ãƒ©ã‚¹åã¯è‡ªå‹•ã§ã‚½ãƒ¼ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

è©¦ã—ã«ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦ `*.html.twig` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç„¡ç†ã‚„ã‚Š `html` ãƒ‘ãƒ¼ã‚µãƒ¼ã®é©ç”¨å¯¾è±¡ã«ã—ã¦ `prettier-plugin-tailwindcss` ã‚’é©ç”¨ã—ã¦ã¿ã¾ã—ãŸã€‚

```json5
// .prettierrc
{
  "plugins": ["prettier-plugin-tailwindcss"],
  "overrides": [
    {
      "files": "*.html.twig",
      "options": {
        "parser": "html"
      }
    }
  ]
}
```

ã™ã‚‹ã¨ã€`{% ... %}` ã‚„ `{{ ... }}` `{# ... #}` ã¨ã„ã£ãŸTwigæ§‹æ–‡ã®ç®‡æ‰€ãŒèª¤ã£ã¦ãã¡ã‚ƒãã¡ã‚ƒã«æ•´å½¢ã•ã‚Œã¦ã—ã¾ã„ã¾ã—ãŸã€‚`html` ãƒ‘ãƒ¼ã‚µãƒ¼ãŒçŸ¥ã‚‰ãªã„èªå½™ãªã®ã§å½“ç„¶ã§ã™ã­ã€‚

ã©ã†ã‚„ã‚‰Twigã‚’ãƒ‘ãƒ¼ã‚¹ã§ãã‚‹Prettierãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½µç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã§ã™ã€‚ã‚°ã‚°ã£ã¦ã¿ã‚‹ã¨ [@zackad/prettier-plugin-twig](https://github.com/zackad/prettier-plugin-twig) ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚

ãŸã ã—ã€ã“ã‚Œã‚’æ™®é€šã«å°å…¥ã—ã¦ã‚‚ã€`prettier-plugin-tailwindcss` ã‚’é©ç”¨ã™ã‚‹ãŸã‚ã« `overrides` ã§ `html` ãƒ‘ãƒ¼ã‚µãƒ¼ã‚’å½“ã¦ã¦ã—ã¾ã†ã¨Twigãƒ‘ãƒ¼ã‚µãƒ¼ã¯æ©Ÿèƒ½ã—ãªããªã£ã¦ã—ã¾ã†ãŸã‚ã€ä½µç”¨ã™ã‚‹ã«ã¯ãŠãã‚‰ã

* https://github.com/prettier/prettier/issues/12807#issuecomment-1285968907
* https://github.com/tailwindlabs/prettier-plugin-tailwindcss/issues/31#issuecomment-1195411734

ã“ã®è¾ºã®ãƒãƒƒã‚¯ã‚’ä½¿ã£ã¦ã¡ã‚‡ã£ã¨å¤‰ãªã“ã¨ã‚’ã™ã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã§ã™ã€‚ï¼ˆè©¦ã—ã¦ã¾ã›ã‚“ğŸ™ï¼‰

ã¾ãŸã€ãã‚‚ãã‚‚ä¸Šè¨˜ã® `@zackad/prettier-plugin-twig` ã«ã‚ˆã‚‹è‡ªå‹•æ•´å½¢ã‚’è©¦ã—ã¦ã¿ãŸã¨ã“ã‚ã€å°‘ãªãã¨ã‚‚ `<script>...</script>` ã§ç›´æ¥åŸ‹ã‚è¾¼ã‚“ã§ã„ã‚‹JSã‚³ãƒ¼ãƒ‰ã®æ”¹è¡Œã¨ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒæ¶ˆã•ã‚Œã¦ã—ã¾ã†å•é¡ŒãŒã‚ã‚Šã€å°å…¥ã¯èºŠèº‡ã•ã‚Œã¾ã—ãŸã€‚ï¼ˆãã‚“ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ããªã¨è¨€ã‚ã‚ŒãŸã‚‰ãã‚Œã¾ã§ã§ã™ãŒâ€¦ï¼‰

æ¬²ã—ã„ã®ã¯ãŸã ã® **ãƒ•ã‚¡ã‚¤ãƒ«å†…ã® `class="..."` ã®ä¸­èº«ã«ã ã‘ `prettier-plugin-tailwindcss` ã‚’é©ç”¨ã—ã¦ãã‚Œã‚‹å›** ãªã®ã§ã€ãã†ã„ã†æ©Ÿèƒ½ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ã—ã¦è‡ªåˆ†ã§ä½œã£ã¦ã—ã¾ãˆã° **Twigã«é™ã‚‰ãšä»»æ„ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨€èªã§ä½¿ãˆã‚‹** ã—ä¾¿åˆ©ãªã®ã§ã¯ï¼Ÿã¨æ€ã£ãŸã®ã§ã—ãŸã€‚

# ä½¿ã„æ–¹

```shell
npm install -D prettier \
               prettier-plugin-tailwindcss \
               @ttskch/prettier-plugin-tailwindcss-anywhere
```

ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚å†…éƒ¨çš„ã« `prettier-plugin-tailwindcss` ã‚’ä½¿ç”¨ã™ã‚‹ã®ã§ã€`prettier` `prettier-plugin-tailwindcss` ã¨ä¸€ç·’ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ä¾‹ãˆã°Twigãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å‡¦ç†ã—ãŸã„å ´åˆãªã‚‰ã€`.prettierrc` ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚

```json5
// .prettierrc
{
  "plugins": ["prettier-plugin-tailwindcss", "@ttskch/prettier-plugin-tailwindcss-anywhere"],
  "overrides": [
    {
      "files": "*.html.twig",
      "options": {
        "parser": "anywhere",
      }
    }
  ]
}
```

`anywhere` ã¨ã„ã†ã®ãŒ `@ttskch/prettier-plugin-tailwindcss-anywhere` ãŒæä¾›ã™ã‚‹ãƒ‘ãƒ¼ã‚µãƒ¼ã®åç§°ã§ã™ã€‚

ã“ã®è¨­å®šã§Prettierã«ã‚ˆã‚‹è‡ªå‹•æ•´å½¢ã‚’å®Ÿè¡Œã™ã‚Œã°ã€ä»¥ä¸‹ã®ã‚ˆã†ã« `*.html.twig` ãƒ•ã‚¡ã‚¤ãƒ«å†…ã® `class="..."` ã®å€¤éƒ¨åˆ†ã«ã®ã¿ `prettier-plugin-tailwindcss` ã«ã‚ˆã‚‹ã‚¯ãƒ©ã‚¹åã‚½ãƒ¼ãƒˆãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚

**Before**

```twig
{% extends 'base.html.twig %}
  {% block content %}
    <div class="space-y-4 flex-col flex">
      <div class="p-4 rounded-lg bg-blue-500 text-white rounded-lg p-4">
        Hello, {{ name }}!
      </div>
    </div>
  {% endblock %}
{% endblock %}
```

**After**

```diff
  {% extends 'base.html.twig %}
    {% block content %}
-     <div class="space-y-4 flex-col flex">
+     <div class="flex flex-col space-y-4">
-       <div class="p-4 rounded-lg bg-blue-500 text-white rounded-lg p-4">
+       <div class="rounded-lg bg-blue-500 p-4 text-white">
          Hello, {{ name }}!
        </div>
      </div>
    {% endblock %}
  {% endblock %}
```

Twigã®å ´åˆã€ä»¥ä¸‹ã®ã‚ˆã†ã« `class="..."` ã®å€¤éƒ¨åˆ†ã®ä¸­ã« `{% %}` ã‚„ `{{ }}`ãŒåŸ‹ã‚è¾¼ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã‚‚ã‚ã‚Šãˆã¾ã™ã€‚

```twig
<div class="space-y-4 flex-col flex {% if foo %}is-foo{% endif %}">
```

ã“ã®ã‚ˆã†ãªå ´åˆã¯ã€ã‚½ãƒ¼ãƒˆå¯¾è±¡ã¨ã—ãŸã„ã‚¯ãƒ©ã‚¹å±æ€§ã®å€¤éƒ¨åˆ†ã‚’å–ã‚Šå‡ºã™ãŸã‚ã®æ­£è¦è¡¨ç¾ã‚’ `regex` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æ˜ç¤ºçš„ã«è¨­å®šã™ã‚‹ã¨ã‚ˆã„ã§ã™ã€‚

```json5
// .prettierrc
{
  "plugins": ["prettier-plugin-tailwindcss", "@ttskch/prettier-plugin-tailwindcss-anywhere"],
  "overrides": [
    {
      "files": "*.html.twig",
      "options": {
        "parser": "anywhere",
        "regex": "class=\"([^{}\"]*)(?:\"| {)", // <-- here
      }
    }
  ]
}
```

ä¸Šè¨˜ã®æ­£è¦è¡¨ç¾ã¯ã€

* ä»¥ä¸‹ã®å ´åˆã«ãƒãƒƒãƒ
    1. `class="` ã§å§‹ã¾ã£ã¦
    2. `{}"` ã®ã„ãšã‚Œã§ã‚‚ãªã„æ–‡å­—ãŒç¹°ã‚Šè¿”ã•ã‚ŒãŸã®ã¡
    3. `"` ã¾ãŸã¯ ` {` ã§é–‰ã˜ã‚‰ã‚ŒãŸ
* ã—ã€2 ã®éƒ¨åˆ†ãŒ1ç•ªç›®ã®ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã—ã¦å¾Œæ–¹å‚ç…§ã§ãã‚‹

ã“ã¨ã‚’è¡¨ç¾ã—ã¦ã„ã¾ã™ã€‚ã“ã®å¾Œæ–¹å‚ç…§ã«ã‚ˆã£ã¦ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã‚½ãƒ¼ãƒˆå¯¾è±¡ç®‡æ‰€ã‚’çŸ¥ã‚‹ãŸã‚ã€`()` ã§æ‹¬ã‚‹ã®ã‚’å¿˜ã‚ŒãŸã‚Šã€å€¤éƒ¨åˆ†ã‚ˆã‚Šå‰ã«ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚°ãƒ«ãƒ¼ãƒ—ãŒã‚ã£ãŸã‚Šã™ã‚‹ã¨æœŸå¾…ã©ãŠã‚Šã«å‹•ä½œã—ãªã„ã®ã§ã”æ³¨æ„ãã ã•ã„ã€‚

ã“ã®è¨­å®šã§å®Ÿè¡Œã™ã‚‹ã¨ã€å…ˆã»ã©ã®ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ•´å½¢ã•ã‚Œã¾ã™ã€‚

```diff
- <div class="space-y-4 flex-col flex {% if foo %}is-foo{% endif %}">
+ <div class="flex flex-col space-y-4 {% if foo %}is-foo{% endif %}">
```

`{% %}` ã‚ˆã‚Šã‚‚å‰ã®éƒ¨åˆ†ã ã‘ãŒé©åˆ‡ã«ã‚½ãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã™ã­ã€‚

> ãŠå¯Ÿã—ã®ã¨ãŠã‚Šã€`{% %}` ãŒå€¤ã®æœ«å°¾ã§ã¯ãªãä¸­ã»ã©ã«ã‚ã£ãŸã‚Šã™ã‚‹ã¨ã€å¾ŒåŠéƒ¨åˆ†ã¯ã‚½ãƒ¼ãƒˆã•ã‚Œãªããªã£ã¦ã—ã¾ã—ã¾ã™ã€‚ãã®è¾ºã¯æ°—ã‚’ã¤ã‘ãªãŒã‚‰Twigã‚’æ›¸ã„ã¦ãã ã•ã„ğŸ™

ã¨ã„ã†ã‚ã‘ã§ã€`@ttskch/prettier-plugin-tailwindcss-anywhere` ã®ã”ç´¹ä»‹ã§ã—ãŸã€‚ã‚ˆã‹ã£ãŸã‚‰ä½¿ã£ã¦ã¿ã¦ãã ã•ã„ï¼†æ°—ã«å…¥ã£ã¦ã„ãŸã ã‘ãŸæ–¹ã¯ãœã²ã‚¹ã‚¿ãƒ¼ãŠé¡˜ã„ã—ã¾ã™ï¼

https://github.com/ttskch/prettier-plugin-tailwindcss-anywhere/

# ã“ã®Prettierãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä½œã‚Šæ–¹

https://zenn.dev/ttskch/articles/52d9713011fd03

ã“ã¡ã‚‰ã®è¨˜äº‹ã§ã€ã“ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä½œã‚Šæ–¹ã«ã¤ã„ã¦è§£èª¬ã—ã¦ã„ã¾ã™ã€‚

ã‚ˆã‚ã—ã‘ã‚Œã°ã€å‚è€ƒã«ã—ã¦ä½•ã‹ç´ æ•µãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½œã£ã¦ã¿ã¦ãã ã•ã„âœ¨
