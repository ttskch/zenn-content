---
title: "[Flutter] SnackBarã‚’ä½¿ãŠã†ã¨ã™ã‚‹ã¨ Scaffold.of() called withï¼ˆç•¥ï¼‰ã¨è¨€ã‚ã‚Œã‚‹ã¨ãã®å¯¾å¿œ"
emoji: "ğŸ’»"
type: "tech"
topics: ["flutter"]
published: true
published_at: 2020-08-09
---

:::message
ã“ã®è¨˜äº‹ã¯ã€2020-08-09ã«åˆ¥ã®ãƒ–ãƒ­ã‚°åª’ä½“ã«æŠ•ç¨¿ã—ãŸè¨˜äº‹ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã§ã™ã€‚
:::

å°ãƒã‚¿ã§ã™ã€‚

Flutterã§ [SnackBar](https://api.flutter.dev/flutter/material/SnackBar-class.html) ã‚’ä½¿ãŠã†ã¨ã—ãŸã‚‰

```
Scaffold.of() called with a context that does not contain a Scaffold.
```

ã¿ãŸã„ãªæ„Ÿã˜ã§æ€’ã‚‰ã‚ŒãŸã“ã¨ã‚ã‚Šã¾ã™ã‚ˆã­ã€‚

> ã¡ãªã¿ã«ã‚¨ãƒ©ãƒ¼ã®å…¨æ–‡ã¯ä»¥ä¸‹ã€‚
> 
> ```
> â•â•â•¡ EXCEPTION CAUGHT BY GESTURE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
> The following assertion was thrown while handling a gesture:
> Scaffold.of() called with a context that does not contain a Scaffold.
> No Scaffold ancestor could be found starting from the context that was passed to Scaffold.of(). This
> usually happens when the context provided is from the same StatefulWidget as that whose build
> function actually creates the Scaffold widget being sought.
> There are several ways to avoid this problem. The simplest is to use a Builder to get a context that
> is "under" the Scaffold. For an example of this, please see the documentation for Scaffold.of():
>   https://api.flutter.dev/flutter/material/Scaffold/of.html
> A more efficient solution is to split your build function into several widgets. This introduces a
> new context from which you can obtain the Scaffold. In this solution, you would have an outer widget
> that creates the Scaffold populated by instances of your new inner widgets, and then in these inner
> widgets you would use Scaffold.of().
> A less elegant but more expedient solution is assign a GlobalKey to the Scaffold, then use the
> key.currentState property to obtain the ScaffoldState rather than using the Scaffold.of() function.
> The context used was:
>   Settings
> When the exception was thrown, this was the stack:
> #0      Scaffold.of 
> package:flutter/â€¦/material/scaffold.dart:1451
> #1      _SettingsState.build.<anonymous closure> 
> package:match/pages/settings.dart:86
> #2      _InkResponseState._handleTap 
> package:flutter/â€¦/material/ink_well.dart:992
> #3      _InkResponseState.build.<anonymous closure> 
> package:flutter/â€¦/material/ink_well.dart:1098
> #4      GestureRecognizer.invokeCallback 
> package:flutter/â€¦/gestures/recognizer.dart:184
> #5      TapGestureRecognizer.handleTapUp 
> package:flutter/â€¦/gestures/tap.dart:524
> #6      BaseTapGestureRecognizer._checkUp 
> package:flutter/â€¦/gestures/tap.dart:284
> #7      BaseTapGestureRecognizer.acceptGesture 
> package:flutter/â€¦/gestures/tap.dart:256
> #8      GestureArenaManager.sweep 
> package:flutter/â€¦/gestures/arena.dart:158
> ```

ã“ã®ã‚ˆã†ãªå ´åˆã®å¯¾ç­–ã«ã¤ã„ã¦ã§ã™ã€‚

çµè«–ã¨ã—ã¦ã¯ã€å†…éƒ¨ã§ `SnackBar` ã‚’ä½¿ã„ãŸã„ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚’ [`Builder`](https://api.flutter.dev/flutter/widgets/Builder-class.html) ã§ãƒ©ãƒƒãƒ—ã—ã¦ã‚ã’ã¦ã€æ–°ã—ã„ `BuildContext` ã‚’ä½¿ã£ã¦ `SnackBar` ã‚’å‡ºåŠ›ã—ã¦ã‚ã’ã‚Œã°ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã›ã‚“ã€‚

**Before**

```dart
@override
Widget build(BuildContext context) {
  return Scaffold(
    appBar: AppBar(
      title: Text('ã»ã’'),
    ),
    body: Center(
      child: RaisedButton(
        child: Text('ä¿å­˜'),
        onPressed: () {
          Scaffold.of(context).showSnackBar(SnackBar(
            content: Text('SnackBarã¯æ­£å¸¸ã«å‹•ä½œã—ã¾ã›ã‚“'),
          )),
        },
      ),
    ),
  );
}
```

**After**

```dart
@override
Widget build(BuildContext context) {
  return Scaffold(
    appBar: AppBar(
      title: Text('ã»ã’'),
    ),
    body: Builder(
      builder: (BuildContext context) {
        return Center(
          child: RaisedButton(
            child: Text('ä¿å­˜'),
            onPressed: () {
              Scaffold.of(context).showSnackBar(SnackBar(
                content: Text('SnackBarãŒæ­£å¸¸ã«å‹•ä½œã—ã¾ã™'),
              ));
            },
          ),
        );
      },
    ),
  );
}
```

ã“ã‚“ãªæ„Ÿã˜ã€‚

> å‚è€ƒï¼š[flutter - Scaffold.of() called with a context that does not contain a Scaffold - Stack Overflow](https://stackoverflow.com/questions/51304568/scaffold-of-called-with-a-context-that-does-not-contain-a-scaffold#answer-51304732)

ä»–ã«ã‚‚

* `SnackBar` ã®ä»£ã‚ã‚Šã« [fluttertoast](https://pub.dev/packages/fluttertoast) ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã†
* [get](https://pub.dev/packages/get#snackbars) ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦ `BuildContext` ä¸è¦ã§ `SnackBar` ã‚’å‡ºåŠ›ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹

ã¨ã„ã£ãŸæ–¹æ³•ã‚‚æ¤œè¨ã—ã¦ã¿ã¦ã‚‚ã„ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

> `get` ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†å ´åˆã¯ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã ã‘ã§ã¯ãªãã€[å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://pub.dev/packages/get) ã® `Step 1` `Step 2` `Step 3` ã®æ‰‹é †ã§æº–å‚™ã‚’ã—ãªã„ã¨å‹•ä½œã—ãªã„ã®ã§è¦æ³¨æ„ã§ã™ã€‚
