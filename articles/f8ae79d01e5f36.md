---
title: "[Symfony/Form] CheckboxTypeã§ã‚‚ãƒ©ãƒ™ãƒ«åˆ—ã‚’å‡ºåŠ›ã—ãŸã„"
emoji: "ğŸ»"
type: "tech"
topics: ["php", "symfony"]
published: true
published_at: 2020-08-05
---

:::message
ã“ã®è¨˜äº‹ã¯ã€2020-08-05ã«åˆ¥ã®ãƒ–ãƒ­ã‚°åª’ä½“ã«æŠ•ç¨¿ã—ãŸè¨˜äº‹ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã§ã™ã€‚
:::

# twig-bridgeã«ã¯Bootstrap4ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ãƒ¼ãƒãŒåŒæ¢±ã•ã‚Œã¦ã„ã‚‹

[symfony/twig-bundle](https://github.com/symfony/twig-bundle) çµŒç”±ã§è‡ªå‹•ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ [symfony/twig-bridge](https://github.com/symfony/twig-bridge) ã«ã¯ã€

* [bootstrap_4_layout.html.twig](https://github.com/symfony/twig-bridge/blob/7a6bcb6510d48b41d1627ae556a836eb9ce74d12/Resources/views/Form/bootstrap_4_layout.html.twig)
* [bootstrap_4_horizontal_layout.html.twig](https://github.com/symfony/twig-bridge/blob/7a6bcb6510d48b41d1627ae556a836eb9ce74d12/Resources/views/Form/bootstrap_4_horizontal_layout.html.twig)

ã¨ã„ã†2ã¤ã®ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ãƒ¼ãƒãŒå…¥ã£ã¦ã„ã¾ã™ã€‚

`config/packages/twig.yaml` ã§ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ãƒ¼ãƒã¨ã—ã¦ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã™ã‚‹ã ã‘ã§ã€ç°¡å˜ã«Symfonyã®ãƒ•ã‚©ãƒ¼ãƒ ã‚’Bootstrap4ã®è¦‹ãŸç›®ã§å‡ºåŠ›ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã€ã¨ã¦ã‚‚ä¾¿åˆ©ã§ã™ã€‚

```yaml
// config/packages/twig.yaml
twig:
    # ...
    form_themes:
#        - 'bootstrap_4_layout.html.twig'
        - 'bootstrap_4_horizontal_layout.html.twig' # é…åˆ—ã®æœ€å¾Œã®è¦ç´ ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ†ãƒ¼ãƒã«ãªã‚‹
```

# ã“ã®ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ãƒ¼ãƒã§ã¯ã€CheckboxTypeã«ã¯ãƒ©ãƒ™ãƒ«åˆ—ãŒå‡ºåŠ›ã•ã‚Œãªã„

ã¨ã¦ã‚‚ä¾¿åˆ©ãªã®ã§ã™ãŒã€å€‹äººçš„ã«ã¯ã„ãã¤ã‹ä¸æº€ç‚¹ã‚‚ã‚ã‚Šã€æ™®æ®µã¯è‡ªåˆ†ã§twigã‚’æ‹¡å¼µã—ã¦å¤šå°‘æ‰‹ç›´ã—ã‚’ã—ãŸçŠ¶æ…‹ã§ä½¿ã£ã¦ã„ã¾ã™ã€‚

ãã®ä¸æº€ç‚¹ã®ä¸€ã¤ãŒã€ **CheckboxTypeã«ã¯ãƒ©ãƒ™ãƒ«åˆ—ãŒå‡ºåŠ›ã•ã‚Œãªã„** ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚

ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ã«CheckboxTypeã®ãƒ•ã‚©ãƒ¼ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ä½œã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```php
class ContactType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            // ...
            ->add('news_letters', CheckboxType::class, [
                'label' => 'News letters',
                'required' => false,
            ])
            // ...
        ;
    }
}
```

ã“ã®å ´åˆã€å‡ºåŠ›ã•ã‚Œã‚‹HTMLã¯ä¸‹å›³ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

> å¿…é ˆé …ç›®ã« `required` ã¨ã„ã†ãƒãƒƒã‚¸ã‚’è¡¨ç¤ºã—ã¦ã„ã‚‹ã®ã¯è‡ªåˆ†ã®CSSã§ã™ğŸ™

**`bootstrap_4_horizontal_layout.html.twig` ã§è¡¨ç¤º**

![](https://tva1.sinaimg.cn/large/007S8ZIlgy1ghet3oaf7ij31t20q2mz4.jpg)

**`bootstrap_4_layout.html.twig` ã§è¡¨ç¤º**

![](https://tva1.sinaimg.cn/large/007S8ZIlgy1ghet85gm2hj31jd0u040t.jpg)

åˆ¥ã«ã“ã‚Œã¯ã“ã‚Œã§ãŠã‹ã—ããªã„ã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€å€‹äººçš„ã«ã¯

* ä»–ã®é …ç›®ã®ã‚ˆã†ã«ãƒ©ãƒ™ãƒ«åˆ—ã‚’è¡¨ç¤ºã—ã¦ã€ãã“ã« `News letters` ã¨è¡¨ç¤º
* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹è‡ªä½“ã®ãƒ©ãƒ™ãƒ«ã«ã¯ã“ã®å ´åˆãªã‚‰ `Subscribe` ãªã©ã¨è¡¨ç¤º

ã¨ã„ã†è¦‹ã›æ–¹ãŒã—ãŸã„ã§ã™ğŸ¤”

# ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ãƒ¼ãƒã‚’æ‹¡å¼µã—ã¦å¯¾å¿œã—ã¦ã¿ã‚‹

ã¨ã„ã†ã‚ã‘ã§ã€ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ãƒ¼ãƒã®twigã‚’æ‹¡å¼µã—ã¦ã“ã®è¦æœ›ã«å¯¾å¿œã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

ç´°ã‹ã„è§£èª¬ã¯çœãã¾ã™ãŒã€ `bootstrap_4_layout.html.twig` ã¨ `bootstrap_4_horizontal_layout.html.twig` ï¼ˆãŠã‚ˆã³ãã®ç¶™æ‰¿å…ƒã®twigï¼‰ã¨ã«ã‚‰ã‚ã£ã“ã—ãªãŒã‚‰æ ¼é—˜ã—ãŸçµæœã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã§ä¸Šæ‰‹ãå¯¾å¿œã§ãã¾ã—ãŸã€‚

```twig
// templates/form_theme/bootstrap_4_layout.html.twig

{% use 'bootstrap_4_layout.html.twig' %}

{# CheckboxTypeã«å¯¾ã—ã¦ãƒ©ãƒ™ãƒ«åˆ—ã‚’å‡ºåŠ›ã™ã‚‹ãŸã‚ã«ä¸Šæ›¸ãã—ã¦ä¸€éƒ¨ã‚’ä¿®æ­£ #}
{% block form_row -%}
  {%- if compound is defined and compound -%}
    {%- set element = 'fieldset' -%}
  {%- endif -%}
  {%- set widget_attr = {} -%}
  {%- if help is not empty -%}
    {%- set widget_attr = {attr: {'aria-describedby': id ~"_help"}} -%}
  {%- endif -%}
  <{{ element|default('div') }}{% with {attr: row_attr|merge({class: (row_attr.class|default('') ~ ' form-group')|trim})} %}{{ block('attributes') }}{% endwith %}>

  {# ã“ã“ã‚’ä¿®æ­£ #}
  {% if label_attr.value is defined %}
    {{ block('form_label') }}
  {% else %}
    {{- form_label(form) -}}
  {% endif %}

  {# ã“ã“ã‚’ä¿®æ­£ #}
  <div class="d-block">
    {{- form_widget(form, widget_attr) -}}
  </div>

  {{- form_help(form) -}}
  </{{ element|default('div') }}>
{%- endblock form_row %}

{# ãƒ©ãƒ™ãƒ«ã®æ–‡è¨€ã‚’ label_attr.value ã§åˆ¶å¾¡ã™ã‚‹ãŸã‚ã«ä¸Šæ›¸ã #}
{% block checkbox_radio_label -%}
  {% if label_attr.value is defined %}
    {% set label = label_attr.value %}
  {% endif %}
  {{ parent() }}
{%- endblock checkbox_radio_label %}
```

```twig
// templates/form_theme/bootstrap_4_horizontal_layout.html.twig

{% use 'bootstrap_4_horizontal_layout.html.twig' %}

{# CheckboxTypeã«å¯¾ã—ã¦ãƒ©ãƒ™ãƒ«åˆ—ã‚’å‡ºåŠ›ã™ã‚‹ãŸã‚ã«ä¸Šæ›¸ãã—ã¦ä¸€éƒ¨ã‚’ä¿®æ­£ #}
{% block checkbox_row -%}
  <div{% with {attr: row_attr|merge({class: (row_attr.class|default('') ~ ' form-group row')|trim})} %}{{ block('attributes') }}{% endwith %}>{#--#}

    {# ã“ã“ã‚’ä¿®æ­£ #}
    {% if label_attr.value is defined %}
      {{ block('form_label') }}
    {% else %}
      <div class="{{ block('form_label_class') }}"></div>{#--#}
    {% endif %}

    <div class="{{ block('form_group_class') }}">
      {{- form_widget(form) -}}
      {{- form_help(form) -}}
    </div>{#--#}
  </div>
{%- endblock checkbox_row %}

{# ãƒ©ãƒ™ãƒ«ã®æ–‡è¨€ã‚’ label_attr.value ã§åˆ¶å¾¡ã™ã‚‹ãŸã‚ã«ä¸Šæ›¸ã #}
{% block checkbox_radio_label -%}
  {% if label_attr.value is defined %}
    {% set label = label_attr.value %}
  {% endif %}
  {{ parent() }}
{%- endblock checkbox_radio_label %}
```

ã“ã‚Œã‚‰ã®å†…å®¹ã§

* `templates/form_theme/bootstrap_4_layout.html.twig`
* `templates/form_theme/bootstrap_4_horizontal_layout.html.twig`

ã‚’ä½œæˆã—ã¦ã€

```yaml
// config/packages/twig.yaml
twig:
    # ...
    form_themes:
#        - 'form_theme/bootstrap_4_layout.html.twig'
        - 'form_theme/bootstrap_4_horizontal_layout.html.twig' # é…åˆ—ã®æœ€å¾Œã®è¦ç´ ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ†ãƒ¼ãƒã«ãªã‚‹
```

ã®ã‚ˆã†ã«ã—ã¦ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ãƒ¼ãƒã‚’å·®ã—æ›¿ãˆã¦æœ‰åŠ¹åŒ–ã—ã¾ã™ã€‚

ãã—ã¦ã€FormTypeã«ä»¥ä¸‹ã®ã‚ˆã†ã« `label_attr.value` ã‚’è¿½åŠ ã—ã€ãã“ã§ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹è‡ªä½“ã«ä»˜åŠ ã—ãŸã„ãƒ©ãƒ™ãƒ«ã®æ–‡å­—åˆ—ã‚’è¨­å®šã—ã¾ã™ã€‚

```diff
  class ContactType extends AbstractType
  {
      public function buildForm(FormBuilderInterface $builder, array $options)
      {
          $builder
  
              // ...
  
              ->add('news_letters', CheckboxType::class, [
                  'label' => 'News letters',
                  'required' => false,
+                 'label_attr' => [
+                     'value' => 'Subscribe',
+                     'class' => 'checkbox-inline', // ã“ã‚Œã¯ã¤ã„ã§ã«è¦‹ãŸç›®ã‚’æ•´ãˆã‚‹ãŸã‚
+                 ],
              ])
  
              // ...
          ;
      }
  }
```

ã“ã‚Œã§ã€è¡¨ç¤ºçµæœã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

**`bootstrap_4_horizontal_layout.html.twig` ã§è¡¨ç¤º**

![](https://tva1.sinaimg.cn/large/007S8ZIlgy1ghetm96eelj31t00qumz9.jpg)

**`bootstrap_4_layout.html.twig` ã§è¡¨ç¤º**

![](https://tva1.sinaimg.cn/large/007S8ZIlgy1ghetmt0p55j31gj0u040z.jpg)

ç¾ã—ã„ã§ã™ã­ğŸ˜‡

ã¡ãªã¿ã«ã€ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã„ãŸã ã‘ã‚Œã°åˆ†ã‹ã‚‹ã¨æ€ã„ã¾ã™ãŒã€ `label_attr.value` ã‚’è¨­å®šã—ãªã‘ã‚Œã°ä»Šã¾ã§ã©ãŠã‚Šã®è¡¨ç¤ºã«ãªã‚‹ã®ã§ã€å¿…è¦ã«å¿œã˜ã¦ä½¿ã„åˆ†ã‘ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ğŸ‘Œ

# ã¾ã¨ã‚

ã¨ã„ã†ã‚ã‘ã§ã€[symfony/twig-bridge](https://github.com/symfony/twig-bridge) ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å…¥ã£ã¦ã„ã‚‹ `bootstrap_4_layout.html.twig` ã‚„ `bootstrap_4_horizontal_layout.html.twig` ã‚’æ‹¡å¼µã—ã¦CheckboxTypeã§ã‚‚ãƒ©ãƒ™ãƒ«åˆ—ã‚’å‡ºåŠ›ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚

åƒ•ãŒSymfonyã§é–‹ç™ºã™ã‚‹ã¨ãã«æ¯å›ä½¿ã£ã¦ã„ã‚‹è‡³é«˜ã®ã‚¹ã‚±ãƒ«ãƒˆãƒ³ [ttskch/symfony-skeleton](https://github.com/ttskch/symfony-skeleton) ã«ã‚‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã“ã®æ©Ÿèƒ½ã‚’å…¥ã‚Œã¦ã‚ã‚Šã¾ã™ã®ã§ã€ã‚ˆã‚ã—ã‘ã‚Œã°ä½¿ã£ã¦ã¿ã¦ãã ã•ã„ğŸ˜‡
