---
title: "ä¸€è¦§ç”»é¢ã«æ¤œç´¢ã¨ä¸€æ‹¬å‰Šé™¤ã‚’å®Ÿè£…"
---

# ã“ã®ç« ã«å¯¾å¿œã™ã‚‹ã‚³ãƒŸãƒƒãƒˆ

* [ğŸ“ æ¤œç´¢æ©Ÿèƒ½](https://github.com/ttskch/symfony-example-app/commit/653cf63270acb77254ec20703ba2cf36e4c924dc)
* [ğŸ“ ä¸€æ‹¬å‰Šé™¤æ©Ÿèƒ½](https://github.com/ttskch/symfony-example-app/commit/4ec1583fce94f0224190df66488a3e6c9fd82151)

> ãƒ‡ãƒ¢ã‚¢ãƒ—ãƒªã¯æ—¥æœ¬èªã¨è‹±èªã«å¯¾å¿œã™ã‚‹ãŸã‚ã™ã¹ã¦ã®æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã‚’ç¿»è¨³ã—ã¦ã„ã‚‹ã®ã§ã€ã‚³ãƒŸãƒƒãƒˆã®å†…å®¹ã¯æœ¬æ–‡ã®è§£èª¬ã¨è‹¥å¹²ç•°ãªã‚Šã¾ã™ã€‚

# ä¸€è¦§ç”»é¢ã«æ¤œç´¢ã¨ä¸€æ‹¬å‰Šé™¤ã‚’å®Ÿè£…

ã„ã‚ˆã„ã‚ˆã“ã®ç« ã§ãƒ©ã‚¹ãƒˆã§ã™ğŸ’ª

å¤šãã®ã‚±ãƒ¼ã‚¹ã§ä¸€è¦§ç”»é¢ã«ã¯æ¤œç´¢æ©Ÿèƒ½ã¨ä¸€æ‹¬å‰Šé™¤æ©Ÿèƒ½ãŒæ±‚ã‚ã‚‰ã‚Œã‚‹ã®ã§ã€æœ€å¾Œã«ã“ã‚Œã‚’å®Ÿè£…ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚

## æ¤œç´¢æ©Ÿèƒ½

### æ¤œç´¢ãƒ­ã‚¸ãƒƒã‚¯

[TtskchPaginatorBundle](https://github.com/ttskch/TtskchPaginatorBundle) ã‚’å°å…¥ã—ã¦ã„ã‚‹ã®ã§æ¤œç´¢æ©Ÿèƒ½ã‚‚ã¨ã¦ã‚‚ç°¡å˜ã«å°å…¥ã§ãã¾ã™ğŸ‘

ç”¨æ„ã™ã‚‹ã®ã¯

* æ¤œç´¢æ¡ä»¶ã‚’ä¿æŒã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹
* ä¸Šè¨˜ãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹ã« å¯¾å¿œã™ã‚‹FormType
* æ¤œç´¢æ¡ä»¶ã‚’ã‚‚ã¨ã«å®Ÿéš›ã«ã‚¯ã‚¨ãƒªã‚’çµ„ã¿ç«‹ã¦ã¦ã€ãƒšãƒ¼ã‚¸ã‚¹ãƒ©ã‚¤ã‚¹ã¨å…¨ä½“ã®ä»¶æ•°ã‚’å–å¾—ã™ã‚‹ã‚¯ãƒ©ã‚¹

ã®3ã¤ã§ã™ã€‚

åƒ•ã¯ã„ã¤ã‚‚ã“ã‚Œã‚‰ã‚’ãã‚Œãã‚Œ

* `Criteria`
* `SearchType`
* `Paginator`

ã¨åä»˜ã‘ã¦ã€ä»Šå›ã§ã‚ã‚Œã°ä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹æˆã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã„ã¾ã™ã€‚

```bash
$ tree src/Pagination
src/Pagination
â”œâ”€â”€ Criteria
â”‚   â”œâ”€â”€ CustomerCriteria.php
â”‚   â”œâ”€â”€ ProjectCriteria.php
â”‚Â Â  â””â”€â”€ UserCriteria.php
â”œâ”€â”€ Form
â”‚   â”œâ”€â”€ CustomerSearchType.php
â”‚   â”œâ”€â”€ ProjectSearchType.php
â”‚Â Â  â””â”€â”€ UserSearchType.php
â””â”€â”€ Paginator
    â”œâ”€â”€ CustomerPaginator.php
    â”œâ”€â”€ ProjectPaginator.php
    â””â”€â”€ UserPaginator.php
```

ä¾‹ãˆã° `CustomerCriteria` `CustomerSearchType` `CustomerPaginator` ã®ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå†…å®¹ã«ãªã‚Šã¾ã™ã€‚

```php
// src/Pagination/Criteria/CustomerCriteria.php

namespace App\Pagination\Criteria;

use Ttskch\PaginatorBundle\Entity\Criteria;

class CustomerCriteria extends Criteria
{
    public ?string $query = null;
    public ?array $states = null;
}
```

```php
// src/Pagination/Form/CustomerSearchType.php

namespace App\Pagination\Form;

use App\Form\Customer\StateChoiceType;
use App\Pagination\Criteria\CustomerCriteria;
use Symfony\Component\Form\Extension\Core\Type\SearchType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolver;
use Symfony\Contracts\Translation\TranslatorInterface;
use Ttskch\PaginatorBundle\Form\CriteriaType;

class CustomerSearchType extends CriteriaType
{
    public function buildForm(FormBuilderInterface $builder, array $options): void
    {
        parent::buildForm($builder, $options);

        $builder
            ->add('query', SearchType::class, [
                'required' => false,
                'attr' => [
                    'placeholder' => 'å…¨æ–‡æ¤œç´¢',
                    'class' => 'w-100',
                ],
            ])
            ->add('states', StateChoiceType::class, [
                'required' => false,
                'multiple' => true,
                'attr' => [
                    'data-placeholder' => 'çŠ¶æ…‹ã‚’é¸æŠ',
                    'data-allow-clear' => true,
                    'class' => 'w-100',
                ],
            ])
        ;
    }

    public function configureOptions(OptionsResolver $resolver): void
    {
        $resolver->setDefaults([
            'data_class' => CustomerCriteria::class,
            'csrf_protection' => false,
        ]);
    }
}
```

```php
// src/Pagination/Paginator/CustomerPaginator.php

namespace App\Pagination\Paginator;

use App\Entity\Customer;
use App\Pagination\Criteria\CustomerCriteria;
use App\Repository\CustomerRepository;
use Doctrine\ORM\EntityManagerInterface;
use Doctrine\ORM\QueryBuilder;
use Ttskch\PaginatorBundle\Doctrine\Counter;
use Ttskch\PaginatorBundle\Doctrine\Slicer;

class CustomerPaginator
{
    private EntityManagerInterface $em;

    public function __construct(EntityManagerInterface $em)
    {
        $this->em = $em;
    }

    // ãƒšãƒ¼ã‚¸ã‚¹ãƒ©ã‚¤ã‚¹ã‚’å–å¾—ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰
    public function sliceByCriteria(CustomerCriteria $criteria): \ArrayIterator
    {
        $qb = $this->createQueryBuilderFromCriteria($criteria);
        $slicer = new Slicer($qb);

        return $slicer($criteria, true);
    }

    // æ¤œç´¢æ¡ä»¶ã«ä¸€è‡´ã—ãŸãƒ‡ãƒ¼ã‚¿å…¨ä½“ã®ä»¶æ•°ã‚’å–å¾—ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰
    public function countByCriteria(CustomerCriteria $criteria): int
    {
        $qb = $this->createQueryBuilderFromCriteria($criteria);
        $counter = new Counter($qb);

        return $counter($criteria);
    }

    // æ¤œç´¢æ¡ä»¶ã‚’ã‚‚ã¨ã«ã‚¯ã‚¨ãƒªã‚’çµ„ã¿ç«‹ã¦ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰
    public function createQueryBuilderFromCriteria(CustomerCriteria $criteria): QueryBuilder
    {
        $expr = $this->em->getExpressionBuilder();

        /** @var CustomerRepository $repository */
        $repository = $this->em->getRepository(Customer::class);

        $qb = $repository->createQueryBuilder('c')
            ->leftJoin('c.people', 'p')
        ;

        // queryãŒå…¥åŠ›ã•ã‚Œã¦ã„ãŸã‚‰å…¨æ–‡æ¤œç´¢ã§çµã‚Šè¾¼ã¿
        if ($criteria->query !== null) {
            $qb
                ->andWhere($expr->orX(
                    'c.name like :query',
                    'p.fullName like :query',
                    'p.email like :query',
                    'p.tel like :query',
                    'p.note like :query',
                ))
                ->setParameter('query', '%'.str_replace('%', '\%', $criteria->query).'%')
            ;
        }

        // statesãŒæŒ‡å®šã•ã‚Œã¦ã„ãŸã‚‰ä¸€è‡´ã™ã‚‹ã‚‚ã®ã§çµã‚Šè¾¼ã¿
        if ($criteria->states) {
            $qb->andWhere($expr->in('c.state', $criteria->states));
        }

        return $qb;
    }
}
```

### ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©

æ¤œç´¢ãƒ­ã‚¸ãƒƒã‚¯ãŒã§ããŸã‚‰ã€å®Ÿéš›ã«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«é©ç”¨ã—ã¾ã™ã€‚

```diff
- public function index(Context $context): Response
+ public function index(Context $context, CustomerPaginator $paginator): Response
  {
-     $qb = $this->repository->createQueryBuilder('c');
-     $context->initialize('id', new Slicer($qb), new Counter($qb));
+     $context->initialize(
+         'id',
+         [$paginator, 'sliceByCriteria'],
+         [$paginator, 'countByCriteria'],
+         CustomerCriteria::class,
+         CustomerSearchType::class,
+     );
  
      return $this->render('customer/index.html.twig', [
          'slice' => $context->slice,
+         'form' => $context->form->createView(),
      ]);
  }
```

`$context->initialize()` ã®å¼•æ•°ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã—ãŸã ã‘ã§ã™ã€‚

| | å¤‰æ›´å‰ | å¤‰æ›´å¾Œ | å‚™è€ƒ |
| --- | --- | --- | --- |
| ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚½ãƒ¼ãƒˆå¯¾è±¡ | `id` | `c.id` | Paginatorã®ã‚¯ã‚¨ãƒªã§æŒ‡å®šã—ã¦ã„ã‚‹ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ä»˜åŠ  |
| ã‚¹ãƒ©ã‚¤ã‚µãƒ¼ | `new Slicer($pb)` | `[$paginator, 'sliceByCriteria']` | Paginatorã®ã‚¹ãƒ©ã‚¤ã‚µãƒ¼ã‚’ä½¿ç”¨ |
| ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ | `new Counter($pb)` | `[$paginator, 'countByCriteria']` | Paginatorã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’ä½¿ç”¨ |
| Criteria | çœç•¥ | `CustomerCriteria::class` | Criteriaã‚’æŒ‡å®š |
| FormType | çœç•¥ | `CustomerSearchType::class` | FormTypeã‚’æŒ‡å®š |

ã¾ãŸã€`handleRequest()` æ¸ˆã¿ã®Formã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ `$context->form` ã§å–å¾—ã§ãã‚‹ã®ã§ã€ãã‚Œã® `createView()` ã®æˆ»ã‚Šå€¤ã‚’ãƒ“ãƒ¥ãƒ¼ã«æ¸¡ã—ã¦ã„ã¾ã™ã€‚

### ãƒ“ãƒ¥ãƒ¼

ã‚ã¨ã¯ç”»é¢ã«æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚Œã°å®Œäº†ã§ã™ã€‚

æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã¯åŸºæœ¬çš„ã«ã™ã¹ã¦ã®ä¸€è¦§ç”»é¢ã«è¨­ç½®ã™ã‚‹ä¸Šã«ã€ç”»é¢ã«ã‚ˆã£ã¦æ¤œç´¢é …ç›®ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ãŒç•°ãªã‚‹ã®ã§ã€ã‚ã‚‹ç¨‹åº¦ã©ã‚“ãªã‚±ãƒ¼ã‚¹ã§ã‚‚ãã‚Œã„ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã§ãã‚‹ã‚ˆã†åƒ•ãªã‚Šã®ã‚»ãƒ³ã‚¹ã§éƒ¨å“åŒ–ã—ã¦ã‚ã‚Šã¾ã™ã€‚

```twig
{% set row1 %}{% block row1 %}{% endblock %}{% endset %}
{% set row1_col1 %}{% block row1_col1 %}{% endblock %}{% endset %}
{% set row1_col2 %}{% block row1_col2 %}{% endblock %}{% endset %}

{% set row2 %}{% block row2 %}{% endblock %}{% endset %}
{% set row2_col1 %}{% block row2_col1 %}{% endblock %}{% endset %}
{% set row2_col2 %}{% block row2_col2 %}{% endblock %}{% endset %}

{% set row3 %}{% block row3 %}{% endblock %}{% endset %}
{% set row3_col1 %}{% block row3_col1 %}{% endblock %}{% endset %}
{% set row3_col2 %}{% block row3_col2 %}{% endblock %}{% endset %}

{{ form_start(form, {method: 'get', attr: {class: 'form-inline align-items-start'}}) }}
<div class="container ml-0 px-0 mb-3">
  <div class="d-flex flex-column flex-sm-row">

    {# å…¥åŠ›æ¬„ã‚¨ãƒªã‚¢ #}
    <div class="flex-grow-1 d-flex flex-column">
      {% for i in 1..3 %}
        {% set row = attribute(_context, 'row'~i) %}
        {% set col1 = attribute(_context, 'row'~i~'_col1') %}
        {% set col2 = attribute(_context, 'row'~i~'_col2') %}

        {% if row or col1 or col2 %}
          <div class="{{ i > 1 ? 'mt-2' : '' }}">
            {% if row %}
              {{ row }}
            {% else %}
              <div class="d-flex flex-column flex-sm-row">
                {% if col1 %}
                  <div class="w-100 mr-sm-2">
                    {{ col1 }}
                  </div>
                {% endif %}

                {% if col1 or col2 %}
                  <div class="w-100 mt-2 mt-sm-0" style="width:1px">
                    {{ col2 }}
                  </div>
                {% endif %}
              </div>
            {% endif %}
          </div>
        {% endif %}
      {% endfor %}
    </div>

    {# æ¤œç´¢ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ #}
    <div class="mt-2 mt-sm-0 ml-sm-2">
      <button type="submit" class="btn btn-block btn-outline-secondary"><i class="fa fa-search"></i></button>
    </div>
  </div>
</div>
{{ form_end(form) }}
```

ã“ã‚Œã§ã€ `row1` `row1_col1` `row1_col2` ç­‰ã®ãƒ–ãƒ­ãƒƒã‚¯ã« `{{ form_widget(form.query) }}` ãªã©ã‚’å·®ã—è¾¼ã‚ã°ã€ã¨ã¦ã‚‚ã„ã„æ„Ÿã˜ã®è¦‹ãŸç›®ã§è¡¨ç¤ºã•ã›ã¦ãã‚Œã¾ã™ã€‚

> ã¡ãªã¿ã«ã€`{{ form_widget() }}` ã«ã‚ˆã‚‹ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¯ **1å›ã—ã‹è¡Œã‚ã‚Œãªã„ä»•æ§˜** ãªã®ã§ã€
>
> ```twig
> {% if block('row1') is not empty %}
>   {% block row1 %}
> {% endif %}
> ```
>
> ã¿ãŸã„ãªæ›¸ãæ–¹ã‚’ã—ã¦ã—ã¾ã†ã¨ã€**`if` æ–‡ã®ä¸­ã§ä¸€åº¦ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãŒå®Ÿè¡Œã•ã‚Œã¦ã—ã¾ã£ã¦ã€è‚å¿ƒã® `{% block row1 %}` ã®éƒ¨åˆ†ã«ã¯ä½•ã‚‚å‡ºåŠ›ã•ã‚Œãªã„** ã¨ã„ã†ç¾è±¡ã«ãªã‚‹ã®ã§è¦æ³¨æ„ã§ã™ã€‚
>
> ã“ã‚Œã‚’é¿ã‘ã‚‹ãŸã‚ã«ã€ä¸Šè¨˜ã§ã¯ä¸€åº¦ `{% set %}{% block row1 %}{% endblock %}{% endset %}` ã¨ã„ã†ã‚ˆã†ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°çµæœã‚’å¤‰æ•°ã«å…¥ã‚Œã¦ä½¿ã„å›ã™ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

é¡§å®¢ä¸€è¦§ç”»é¢ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã¯ã€ã“ã‚Œã‚’ä½¿ã£ã¦ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’è¿½è¨˜ã—ã¾ã™ã€‚

```twig
{% embed 'widgets/search-form.html.twig' %}
  {% block row1_col1 %}
    {{ form_widget(form.query) }}
  {% endblock %}
  {% block row1_col2 %}
    {{ form_widget(form.states) }}
  {% endblock %}
{% endembed %}
```

ã‚¹ãƒƒã‚­ãƒªã—ã¦ã„ã¦ã‚ˆã„ã§ã™ã­ï¼

### å‹•ä½œç¢ºèª

ã“ã‚Œã§ã€ã“ã‚“ãªæ„Ÿã˜ã®æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ãŒè¨­ç½®ã§ãã¾ã—ãŸï¼ğŸ™Œ

![](https://tva1.sinaimg.cn/large/0081Kckwgy1glxjzwlhhtj327s0jsmxr.jpg)

![](https://tva1.sinaimg.cn/large/0081Kckwgy1glxjzjakdoj327u0ligm6.jpg)

![](https://tva1.sinaimg.cn/large/0081Kckwgy1glxjz7vkr5j327q0lw3z8.jpg)

## ä¸€æ‹¬å‰Šé™¤æ©Ÿèƒ½

ç¶šã„ã¦ä¸€æ‹¬å‰Šé™¤æ©Ÿèƒ½ã§ã™ã€‚

### ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©

ã¾ãšã¯ä¸€æ‹¬å‰Šé™¤ã®ãŸã‚ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†ã€‚ï¼ˆä¾‹ã«ã‚ˆã£ã¦ã€ãƒ•ã‚¡ã‚¤ãƒ«å†…ã§ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å®šç¾©ä½ç½®ã«æ°—ã‚’ã¤ã‘ã¦ãã ã•ã„ğŸ‘Œï¼‰

```php
// src/Controller/CustomerController.php

/**
 * @Route("/multiple", name="delete_multiple", methods={"DELETE"})
 * @IsGranted("ROLE_ALLOWED_TO_EDIT")
 */
public function deleteMultiple(Request $request)
{
    $ids = explode(',', $request->request->get('ids'));

    if ($this->isCsrfTokenValid('delete_multiple', $request->request->get('_token'))) {
        foreach ($ids as $id) {
            $this->em->remove($this->repository->find($id));
        }

        try {
            $this->em->flush();
            $this->addFlash('success', 'é¡§å®¢ã®ä¸€æ‹¬å‰Šé™¤ãŒå®Œäº†ã—ã¾ã—ãŸã€‚');
        } catch (ForeignKeyConstraintViolationException $e) {
            $this->addFlash('danger', 'ãã®é¡§å®¢ã«ç´ã¥ã„ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ãŸã‚å‰Šé™¤ã§ãã¾ã›ã‚“ã€‚');
        }
    }

    return $this->redirectToRouteOrReturn('customer_index');
}
```

ã“ã‚“ãªæ„Ÿã˜ã§ã€ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ `ids` ã§ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã®IDåˆ—ã‚’å—ã‘å–ã£ã¦ã€æŒ‡å®šã•ã‚ŒãŸIDã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ä¸€æ‹¬ã§å‰Šé™¤ã—ã¾ã™ã€‚

`ProjectController` ã«ã‚‚ã¾ã£ãŸãåŒã˜ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æ°—è»½ã«ä¸€æ‹¬å‰Šé™¤ãªã©ã§ããªã„ã»ã†ãŒã„ã„ã®ã§ã€ã‚ãˆã¦ `UserController` ã«ã¯å®Ÿè£…ã—ã¾ã›ã‚“ã€‚

### ãƒ“ãƒ¥ãƒ¼

æ¬¡ã«ã€ä¸€è¦§ç”»é¢ã®ãƒ“ãƒ¥ãƒ¼ã«ä»¥ä¸‹ã®ã‚ˆã†ãªä¸€æ‹¬å‰Šé™¤ã®ãŸã‚ã®ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¨­ç½®ã—ã€

```twig
<form action="{{ pathWithReturnTo('customer_delete_multiple') }}" method="post" onsubmit="return confirm('æœ¬å½“ã«å‰Šé™¤ã—ã¦ã‚ˆã„ã§ã™ã‹ï¼Ÿ')">
  <input type="hidden" name="_method" value="DELETE">
  <input type="hidden" name="_token" value="{{ csrf_token('delete_multiple') }}">
  <input type="hidden" name="ids">
  <a class="multiple-checker-action" onclick="$(this).closest('form').submit();">ä¸€æ‹¬å‰Šé™¤...</a>
</form>
```

ã•ã‚‰ã«è¡Œé¸æŠã®ãŸã‚ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’è¨­ç½®ã—ã¾ã™ã€‚

```twig
<table>
  <thead>
  <tr>
    <th><input type="checkbox" class="multiple-checker-all"></th> {# ã™ã¹ã¦é¸æŠ #}
    {# ... ç•¥ #}
  </tr>
  </thead>
  <tbody>
  {% for customer in slice %}
    <tr>
      <td><input type="checkbox" class="multiple-checker" value="{{ customer.id }}"></td> {# å€‹åˆ¥ã«é¸æŠ #}
      {# ... ç•¥ #}
    </tr>
  {% endfor %}
  </tbody>
</table>
```

### JavaScript

æœ€å¾Œã¯ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®æ“ä½œã«å¿œã˜ã¦ãƒ•ã‚©ãƒ¼ãƒ ã® `ids` ã«å€¤ã‚’ã‚»ãƒƒãƒˆã™ã‚‹å‡¦ç†ã‚’ç´ æœ´ã«jQueryã§å®Ÿè£…ã—ã¾ã™ã€‚

ã¡ã‚‡ã£ã¨é•·ã„ã®ã§ [å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰](https://github.com/ttskch/symfony-example-app/blob/4ec1583fce94f0224190df66488a3e6c9fd82151/assets/js/widgets/multiple-checker.js) ã‚’è¦‹ã¦ã¿ã¦ãã ã•ã„ğŸ™

è¤‡é›‘ã§ã¯ã‚ã‚Šã¾ã™ãŒã€ç‰¹åˆ¥ã«é›£ã—ã„ã“ã¨ã¯ã—ã¦ã„ãªã„ã®ã§ã€èª­ã‚“ã§ã„ãŸã ã‘ã‚Œã°ä½•ã‚’ã—ã¦ã„ã‚‹ã‹ã¯ç†è§£ã§ãã‚‹ã¨æ€ã„ã¾ã™ğŸ‘

JavaScriptã‚’æ›¸ã„ãŸã‚‰å¿˜ã‚Œãšã«WebpackEncoreã«ç™»éŒ²ã—ã¦

```diff
  Encore
+   .addEntry('widgets_multiple-checker', [
+     './assets/js/widgets/multiple-checker.js',
+   ])
```

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§èª­ã¿è¾¼ã‚“ã§ãŠãã¾ã—ã‚‡ã†ã€‚

```twig
{% block javascripts %}
  {{ parent() }}
  {{ encore_entry_script_tags('widgets_multiple-checker') }}
{% endblock %}
```

### å‹•ä½œç¢ºèª

ã“ã‚Œã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¤‡æ•°ã®è¡Œã‚’é¸æŠã—ã¦ä¸€æ‹¬å‰Šé™¤ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸğŸ™Œ

![](https://tva1.sinaimg.cn/large/0081Kckwgy1glxl0wr2i1j327q0n6aau.jpg)

![](https://tva1.sinaimg.cn/large/0081Kckwgy1glxl1lbx60j327q0n0wf2.jpg)

ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å¢—ã‚„ã›ã°ä¸€æ‹¬ç·¨é›†ãªã©åˆ¥ã®ä¸€æ‹¬å‡¦ç†ã«ã‚‚ç°¡å˜ã«å¯¾å¿œã§ãã¾ã™ã­ğŸ‘
